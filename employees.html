<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Employee Management</title>

<style>
body {
    margin: 0;
    font-family: tahoma, sans-serif;
    background: #ffffff;
}

/* PAGE CONTAINER */
.main-content {
    margin-left: 230px;      /* sidebar size */
    padding: 40px;
    width: calc(100% - 230px);
    display: flex;
    justify-content: center; /* center horizontally */
    align-items: flex-start;
}

/* CENTERED CONTAINER */
.container {
    width: 900px; 
    background: #ffffff;
    padding: 40px;
    border-radius: 12px;
    box-shadow: 0 0 25px rgba(0,0,0,0.08);
    max-height: 85vh;
    overflow-y: auto;        /* inside scroll only */
    margin: 0 auto;          /* center fix */
}


/* HEADING */
.container h2 {
    display: inline-block;
    background: linear-gradient(to right, #07AFC0, #1aa853);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-size: 28px;
    margin-bottom: 30px;
    font-weight: bold;
}

/* ROWS */
.row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 35px;
}

.inputGroup {
    width: 32%;
    display: flex;
    flex-direction: column;
}

.inputGroup label {
    font-size: 15px;
    font-weight: bold;
    color: #333;
    margin-bottom: 8px;
}

/* UNDERLINE INPUT */
.inputGroup input, .inputGroup select {
    border: none;
    background: transparent;
    border-bottom: 3px solid #9de79d;
    padding: 10px 5px;
    font-size: 16px;
    outline: none;
}

/* Add Employee Button */
#addEmpBtn {
    padding: 10px 25px;
    
     background: linear-gradient(to right, #07AFC0, #1aa853);
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 16px;
    cursor: pointer;
}
#addEmpBtn:hover { background: linear-gradient(to right, #1aa853, #07AFC0); }

/* Employee Stored Card */
.empCard {
    background: #f5f4f4;
    border-radius: 12px;
    padding: 15px;
    margin-top: 20px;
    border: 1px solid #ffffff;
    border-left: 6px solid #34c759;
}

.twoCol {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
}
.left, .right {
    width: 48%;
}

p {
    margin: 4px 0;
    font-size: 14px;
}

/* Buttons */
.buttons button {
    padding: 7px 15px;
    border: none;
    border-radius: 6px;
    color: white;
    cursor: pointer;
    margin-right: 10px;
}
.editBtn { background: #00bfff; }
.deleteBtn { background: #ff4d4d; }

/* Password Eye Icon */
.eye {
    cursor: pointer;
    margin-left: 10px;
    font-size: 16px;
}



    .sidebar {
    width: 230px;
    height: 100vh;
    position: fixed;
    left: 0;
    top: 0;
    background: linear-gradient(#34caca, #1aa853);  /* same as your screenshot */
    padding-top: 30px;
    box-shadow: 0 0 15px rgba(0,0,0,0.15);
}

/* Logo */


/* Menu buttons */
.sidebar a {
    display: block;
    padding: 12px 20px;
    margin: 10px 15px;
    text-decoration: none;
    color: white;
    font-size: 16px;
    border-radius: 20px;
    transition: 0.3s;
}

/* Hover effect */
.sidebar a:hover {
    background: rgba(255,255,255,0.3);
}

/* Logout button */
.sidebar button {
    display: block;
    padding: 12px 20px;
    margin: 10px 15px;
    text-decoration: none;
    font-size: 16px;
    transition: 0.3s;
    background: white;
    color: #26bfa3;
    border-radius: 30px;
    border: none;
    font-weight: bold;
}



* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: Arial, sans-serif;
}

body {
  height: 100vh;
  background: #fff;
  background-image: url(bgdot.jpeg);
justify-content: space-between;
}

/* PAGE CONTAINER */
 
.wave-container {
  position: fixed;
  top: 0;
  left: 230px;
  width: calc(100% - 230px);
  height: 100vh;
  overflow: hidden;
  z-index: -1;
}

.wave-track {
  position: absolute;
  bottom: 7%;
  display: flex;
  width: 200%;
  animation: waveMove 35s linear infinite;
}

.wave {
  width: 100%;
  height: auto;
  flex-shrink: 0;
}

/* PERFECT seamless animation */
@keyframes waveMove {
  0% {
    transform: translateX(0);
  }
  100% {
    transform: translateX(-50%);
  }
}

/* WAVE BACKGROUND */
.ptimg{
    margin-left: 30px;
    width: 70%;
    
    border-radius: 12px;
    background: #ffffff;
    box-shadow: 0 0 10px rgba(0,0,0,0.2);
    
}
.sidebar img {
        width: 150px;
        height: auto;
        padding: 12px 20px;
        margin-left: 5px;
        align-items: center;
        
}
</style>
<body>
    <div class="wave-container">
  <div class="wave-track">
    <img src="Software.png" class="wave">
    <img src="Software.png" class="wave">
  </div>
</div>
    <div class="sidebar">
    <div class="ptimg"><img src="PTlogo.png" alt=""></div>
    <br>

    <a href="home.html">Home</a>
    <a href="employees.html">Employees</a>
    <a href="attendance.html">Attendance</a>
    <a href="stock.html">Stock</a>
    <a href="cust.html">Customers</a>
    <a href="accounts.html">Accounts</a>
    <a href="expenses.html">Expenses</a>

    <br><br><br><br>

    <button onclick="logout()">Logout</button>
</div>

<div class="main-content">
<div class="container">

    <h2>Employee Registration </h2>

    <!-- Row 1 -->
    <div class="row">
        <div class="inputGroup">
            <label>Employee Name</label>
            <input type="text" id="empName">
        </div>

        <div class="inputGroup">
            <label>Mobile Number</label>
            <input type="text" id="empMobile">
        </div>
        <div class="inputGroup">
            <label>Role</label>
            <select id="empRole">
                <option value="">Select Role</option>
                <option>Founder</option>
                <option>Graphic Designer</option>
                <option>Machine Operator</option>
                <option>Admin</option>
                <option>Fresher</option>
            </select>
        </div>
    </div>

    <!-- Row 2 -->
    <div class="row">

        <div class="inputGroup">
            <label>Username</label>
            <input type="text" id="empUser">
        </div>

        <div class="inputGroup">
            <label>Password</label>
            <input type="password" id="empPass">
        </div>
        <div class="inputGroup" style="width: 32%;">
            <label>Confirm Password</label>
            <input type="password" id="empCPass">
        </div>
    </div>

    <!-- Row 3 -->
    
    <button id="addEmpBtn">Add Employee</button>
   
    <div id="empList"></div>

</div>
</div>
 <script type="module">
  // 1. Firebase Imports
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, collection, doc, setDoc, onSnapshot, query, deleteDoc, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // 2. Firebase Config
  const firebaseConfig = {
       apiKey: "AIzaSyC3yLs6Zx_JuCtGIPVKSrY9gse3ZkAi3Fs",
  authDomain: "printech-c101a.firebaseapp.com",
  projectId: "printech-c101a",
  storageBucket: "printech-c101a.firebasestorage.app",
  messagingSenderId: "629188473697",
  appId: "1:629188473697:web:1ca8e7a5294eb9ec830b20"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const empCol = collection(db, "EmployeesData");

  // 3. Add Employee - Name as Custom ID
  document.getElementById("addEmpBtn").onclick = async () => {
    const name = document.getElementById("empName").value.trim();
    const mobile = document.getElementById("empMobile").value;
    const role = document.getElementById("empRole").value;
    const user = document.getElementById("empUser").value;
    const pass = document.getElementById("empPass").value;
    const cpass = document.getElementById("empCPass").value;

    if (!name || !user || !pass) return alert("Machi, details fill pannu!");
    if (pass !== cpass) return alert("Password match aagala da!");

    try {
      // setDoc use panni 'Name'-ah ID-ah fix panrom
      await setDoc(doc(db, "EmployeesData", name), {
        name: name,
        mobile: mobile,
        role: role,
        user: user,
        pass: pass,
        timestamp: new Date()
      });
      alert(`Employee ${name} added successfully! ‚úÖ`);
      clearAllInputs();
    } catch (e) { 
      alert("Error: " + e.message); 
    }
  };

  // 4. Real-Time Display - Full Fields
  onSnapshot(query(empCol, orderBy("timestamp", "desc")), (snap) => {
    const empList = document.getElementById("empList");
    empList.innerHTML = "";
    
    snap.forEach((docSnap) => {
      const e = docSnap.data();
      const id = docSnap.id; 
      
      const card = document.createElement("div");
      card.className = "empCard";
      
      // Ippo ellamae show aagum machi
      card.innerHTML = `
        <div style="padding: 10px;">
            <p><b>ID (Name):</b> ${id}</p>
            <p><b>Mobile:</b> ${e.mobile || '---'}</p>
            <p><b>Role:</b> ${e.role || '---'}</p>
            <p><b>Username:</b> ${e.user || '---'}</p>
            <p><b>Password:</b> <span id="pwd-${id}">******</span>
                <span class="eye" style="cursor:pointer; margin-left:10px;" onclick="togglePass('${id}', '${e.pass}')">üëÅÔ∏è</span>
            </p>
            
            <div class="buttons" style="margin-top:10px;">
                <button class="deleteBtn" style="background:#ff4d4d; color:white; border:none; padding:5px 15px; border-radius:5px; cursor:pointer;" onclick="deleteEmp('${id}')">Delete</button>
            </div>
        </div>
      `;
      empList.appendChild(card);
    });
  });

  // 5. Global Window Functions
  window.togglePass = (id, actualPass) => {
    let pwd = document.getElementById("pwd-" + id);
    pwd.innerText = (pwd.innerText === "******") ? actualPass : "******";
  };

  window.deleteEmp = async (id) => {
    if (confirm(`Kandippa ${id}-ah delete pannelama machi?`)) {
      await deleteDoc(doc(db, "EmployeesData", id));
    }
  };

  window.logout = () => {
    sessionStorage.clear();
    window.location.href = "login.html";
  };

  function clearAllInputs() {
    document.querySelectorAll("input, select").forEach(el => el.value = "");
  }

  // Auth Protection
  document.addEventListener("DOMContentLoaded", () => {
    let user = JSON.parse(sessionStorage.getItem("loggedUser"));
    if (!user) { window.location.href = "login.html"; return; }
    if (user.role !== "Founder" && user.role !== "Admin") {
        let empLink = document.querySelector("a[href='employees.html']");
        if (empLink) empLink.style.display = "none";
    }
  });
  window.addEventListener('DOMContentLoaded', () => {
    // 1. Session-la irundhu user data-va edu
    const loggedUser = JSON.parse(sessionStorage.getItem("loggedUser"));
    
    if (loggedUser) {
      // 2. Role "Founder" illana Accounts & Expenses-ah maraichidu
      if (loggedUser.role !== "Founder") {
        // Sidebar-la irukkura Accounts & Expenses links-ah 'id' vechu kandupidi
        const accLink = document.querySelector('a[href="employees.html"]');
        
        
        if (accLink) accLink.style.display = 'none';
        if (expLink) expLink.style.display = 'none';
      }
    } else {
      // Login pannala-na veliya thallu
      window.location.href = "login.html";
    }
  });
</script>
</body>
</html>
